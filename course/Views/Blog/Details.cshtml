@model course.Models.Blog
@if (TempData["msg"] != null)
{
    <div class="alert alert-warning">
        @TempData["msg"]
    </div>
}

<main class="main">

    <!-- Page Title -->
    <div class="page-title light-background">
        <div class="container d-lg-flex justify-content-between align-items-center">
            <h1 class="mb-2 mb-lg-0">@Model.Title</h1>
            <nav class="breadcrumbs">
                <ol>
                    <li><a href="/">Trang chủ</a></li>
                    <li class="current">Chi tiết Blog</li>
                </ol>
            </nav>
        </div>
    </div>

    <!-- Blog Details -->
    <section id="blog-details" class="blog-details section">
        <div class="container" data-aos="fade-up">

            <article class="article">

                <!-- Header -->
                <div class="article-header">

                    <h1 class="title" data-aos="fade-up" data-aos-delay="100">
                        @Model.Title
                    </h1>

                    <div class="article-meta" data-aos="fade-up" data-aos-delay="200">
                        <div class="author">
                            <img src="@Model.User.Avatar" alt="Author" class="author-img" />
                            <div class="author-info">
                                <h4>@Model.User.FullName</h4>
                                <span>@Model.User.Email</span>
                            </div>
                        </div>
                        <div class="post-info">
                            <span><i class="bi bi-calendar4-week"></i> @Model.CreatedAt</span>
                            <span><i class="bi bi-chat-square-text"></i> @ViewBag.TotalComments bình luận</span>
                        </div>
                    </div>
                </div>

                <!-- Main Image -->
                <div class="article-featured-image" data-aos="zoom-in">
                    <img src="@Model.Thumbnail" alt="@Model.Title" class="img-fluid" />
                </div>

                <!-- Content -->
                <div class="article-wrapper">
                    <aside class="table-of-contents" data-aos="fade-left">
                        <h3>Table of Contents</h3>
                        <nav>
                            <ul>
                                <li><a href="#introduction" class="active">Introduction</a></li>
                                <li><a href="#skeuomorphism">The Skeuomorphic Era</a></li>
                                <li><a href="#flat-design">Flat Design Revolution</a></li>
                                <li><a href="#material-design">Material Design</a></li>
                                <li><a href="#neumorphism">Rise of Neumorphism</a></li>
                                <li><a href="#future">Future Trends</a></li>
                            </ul>
                        </nav>
                    </aside>
                    <div class="article-content">
                        @Html.Raw(Model.Content)
                    </div>
                </div>

                <!-- Tags -->
                <div class="article-footer" data-aos="fade-up">
                    <div class="article-tags">
                        <h4>Tags</h4>
                        <div class="tags">
                            <span class="tag">Blog</span>
                            <span class="tag">Tin tức</span>
                            <span class="tag">Chia sẻ</span>
                        </div>
                    </div>
                </div>

            </article>

        </div>
    </section>

    <!-- Comments -->
    <section id="blog-comments" class="blog-comments section">
        <div class="container" data-aos="fade-up" data-aos-delay="100">

            <div class="blog-comments-4">
                <div class="comments-header">
                    <h3 class="title">Bình luận</h3>
                    <div class="comments-stats">
                        <span class="count">@ViewBag.TotalComments</span>
                        <span class="label">Bình luận</span>
                    </div>
                </div>

                <div class="comments-container">

                    @foreach (var cmt in ViewBag.Comments)
                    {
                        <div class="comment-thread">
                            <div class="comment-box">
                                <div class="comment-wrapper">
                                    <div class="avatar-wrapper">
                                        <img src="@cmt.User.Avatar" alt="Avatar">
                                    </div>

                                    <div class="comment-content">
                                        <div class="comment-header">
                                            <div class="user-info">
                                                <h4>@cmt.User.FullName</h4>
                                                <span class="time-badge">
                                                    <i class="bi bi-clock"></i>
                                                    @cmt.CreatedAt.ToString("dd/MM/yyyy HH:mm")
                                                </span>
                                            </div>
                                        </div>

                                        <div class="comment-body">
                                            <p>@cmt.Comment</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    }

                </div>
            </div>
        </div>
    </section>

    <!-- Comment Form -->
    <section id="blog-comment-form" class="blog-comment-form section">
    
        <div class="container">

            @if (Context.Session.GetInt32("UserId") == null)
            {
                <div class="alert alert-warning">
                    Vui lòng <a href="/account/login">đăng nhập</a> để bình luận.
                </div>
            }
            else
            {
                <form method="post" action="/blog/comment">

                    <input type="hidden" name="BlogId" value="@Model.BlogId" />

                    <h4>Để lại bình luận</h4>

                    <!-- Rating -->
                    <div class="form-group mb-3">
                        <label>Đánh giá</label>
                        <select name="Rating" class="form-select" required>
                            <option value="">-- Chọn số sao --</option>
                            <option value="5">⭐⭐⭐⭐⭐ (5)</option>
                            <option value="4">⭐⭐⭐⭐ (4)</option>
                            <option value="3">⭐⭐⭐ (3)</option>
                            <option value="2">⭐⭐ (2)</option>
                            <option value="1">⭐ (1)</option>
                        </select>
                    </div>

                    <!-- Comment -->
                    <div class="form-group mb-3">
                        <textarea name="Comment"
                                  class="form-control"
                                  placeholder="Nội dung bình luận *"
                                  required></textarea>
                    </div>

                    <div class="text-center">
                        <button type="submit" class="btn btn-primary">
                            Gửi bình luận
                        </button>
                    </div>

                </form>

            }


        </div>
    </section>

</main>
